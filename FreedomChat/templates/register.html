{% extends "base.html" %}

{% block content %}
<div class="auth-wrapper">
    <div class="auth-container">
        <div class="auth-header">
            <h1 class="auth-title">üöÄ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å!</h1>
            <p class="auth-subtitle">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç FreedomChat</p>
        </div>

        <form method="POST" class="auth-form">
            <div class="form-group">
                <label class="form-label">üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                <input type="text" name="username" class="form-input" placeholder="–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π username" required>
            </div>

            <div class="form-group">
                <label class="form-label">üìß Email –∞–¥—Ä–µ—Å</label>
                <input type="email" name="email" class="form-input" placeholder="your@email.com" required>
            </div>

            <div class="form-group">
                <label class="form-label">üîë –ü–∞—Ä–æ–ª—å</label>
                <input type="password" name="password" class="form-input" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å" required
                       pattern=".{6,}" title="–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
            </div>

            <div class="form-group">
                <label class="form-label">‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                <input type="password" name="confirm_password" class="form-input" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å" required>
            </div>

            <button type="submit" class="btn btn-primary" style="width: 100%;">
                üéØ –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç
            </button>
        </form>

        <div class="auth-divider">
            <span>–∏–ª–∏</span>
        </div>

        <a href="{{ url_for('google_login') }}" class="btn btn-google" style="width: 100%; margin-bottom: 24px;">
            <div class="google-icon"></div>
            –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å Google
        </a>

        <div class="auth-footer" style="text-align: center; margin-top: 32px;">
            <p style="color: var(--text-secondary); margin-bottom: 16px;">
                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?
            </p>
            <a href="{{ url_for('login') }}" class="btn btn-secondary" style="width: 100%;">
                üîê –í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç
            </a>
        </div>

        <div style="text-align: center; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border);">
            <div style="display: grid; gap: 8px; font-size: 14px; color: var(--text-secondary);">
                <div>‚ú® –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
                <div>üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
                <div>üîê –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —á–∞—Ç—ã</div>
                <div>üìû –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏</div>
                <div>üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω</div>
            </div>
        </div>
    </div>
</div>

<style>
.auth-form {
    space-y: 20px;
}

/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è */
.password-strength {
    height: 4px;
    border-radius: 2px;
    margin-top: 8px;
    transition: all 0.3s ease;
}

.password-strength.weak {
    background: var(--danger);
    width: 33%;
}

.password-strength.medium {
    background: var(--warning);
    width: 66%;
}

.password-strength.strong {
    background: var(--success);
    width: 100%;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.auth-container {
    animation: slideIn 0.6s ease-out;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    const passwordInput = document.querySelector('input[name="password"]');
    const confirmInput = document.querySelector('input[name="confirm_password"]');
    
    function validatePassword() {
        const password = passwordInput.value;
        const confirm = confirmInput.value;
        
        if (confirm && password !== confirm) {
            confirmInput.style.borderColor = 'var(--danger)';
            confirmInput.style.boxShadow = '0 0 0 3px rgba(239, 68, 68, 0.1)';
        } else {
            confirmInput.style.borderColor = '';
            confirmInput.style.boxShadow = '';
        }
        
        // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–ª—ã –ø–∞—Ä–æ–ª—è
        let strength = 'weak';
        if (password.length >= 8) strength = 'medium';
        if (password.length >= 12 && /[A-Z]/.test(password) && /[0-9]/.test(password)) {
            strength = 'strong';
        }
    }
    
    if (passwordInput && confirmInput) {
        passwordInput.addEventListener('input', validatePassword);
        confirmInput.addEventListener('input', validatePassword);
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
    const form = document.querySelector('.auth-form');
    if (form) {
        form.addEventListener('submit', function(e) {
            const username = document.querySelector('input[name="username"]').value;
            const email = document.querySelector('input[name="email"]').value;
            const password = document.querySelector('input[name="password"]').value;
            const confirm = document.querySelector('input[name="confirm_password"]').value;
            
            if (!username || !email || !password || !confirm) {
                e.preventDefault();
                showNotification('–û—à–∏–±–∫–∞', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            if (password !== confirm) {
                e.preventDefault();
                showNotification('–û—à–∏–±–∫–∞', '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç', 'error');
                return;
            }
            
            if (password.length < 6) {
                e.preventDefault();
                showNotification('–û—à–∏–±–∫–∞', '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
        });
    }

    // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ username
    const usernameInput = document.querySelector('input[name="username"]');
    if (usernameInput) {
        setTimeout(() => {
            usernameInput.focus();
        }, 100);
    }
});
</script>
{% endblock %}
